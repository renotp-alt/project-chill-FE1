<!doctype html>
<html lang="id">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>CHILL â€” Beranda</title>
  <link rel="stylesheet" href="styles.css" />
  <!-- Hover feedback kecil kalau CSS luar belum ada -->
  <style>
    .clickable-card{ cursor:pointer; position:relative; transition:transform .25s, box-shadow .25s; }
    .clickable-card:hover{ transform:scale(1.05); box-shadow:0 8px 24px rgba(0,0,0,.4); }
    .clickable-card:focus-visible{ outline:2px solid #4664FF; outline-offset:4px; }
    .hover-hint{ position:absolute; left:0; right:0; bottom:6px; text-align:center; font-size:12px; color:rgba(255,255,255,.8); opacity:0; transition:opacity .2s; pointer-events:none; }
    .clickable-card:hover .hover-hint{ opacity:1; }
  </style>
</head>
<body>
  <main class="container" role="main">
    <div id="root"></div>
  </main>

  <!-- React via CDN (pakai vendor lokal dulu, fallback ke unpkg kalau gagal) -->
  <script src="./vendor/react.development.js" onerror="(function(){var s=document.createElement('script');s.crossOrigin='';s.src='https://unpkg.com/react@18/umd/react.development.js';document.head.appendChild(s);})();"></script>
  <script src="./vendor/react-dom.development.js" onerror="(function(){var s=document.createElement('script');s.crossOrigin='';s.src='https://unpkg.com/react-dom@18/umd/react-dom.development.js';document.head.appendChild(s);})();"></script>
  <script src="./vendor/babel.min.js" onerror="(function(){var s=document.createElement('script');s.src='https://unpkg.com/@babel/standalone/babel.min.js';document.head.appendChild(s);})();"></script>

  <script type="text/babel" data-presets="react">
    const { useEffect, useRef } = React;

    /* ========== Utils ========== */
    const slugify = s => (s||'').toLowerCase().replace(/[^a-z0-9]+/g,'-').replace(/(^-|-$)/g,'');

    /* ========== Header ========== */
    function Header({ showProfile, setShowProfile }) {
      return (
        <header className="header">
          <div className="topbar">
            <div className="brand">
              <a href="./home.html" style={{color:'inherit',textDecoration:'none'}}>
                <i className="brand-icon" aria-hidden="true">ðŸŽ¬</i> <span>CHILL</span>
              </a>
            </div>
            <nav aria-label="Navigasi utama">
              <a href="./series.html">Series</a>
              <a href="./film.html">Film</a>
              <a href="./my-list.html">Daftar Saya</a>
            </nav>
            <div className="profile-wrap">
              <div className="avatar" aria-label="Profil" title="Profil"
                   onClick={()=>setShowProfile(!showProfile)} />
              <div className={`profile-dropdown ${showProfile ? 'show' : ''}`}>
                <a href="./profile.html">Profil Saya</a>
                <a href="./plans.html">Ubah Premium</a>
                <a href="./index.html">Keluar</a>
              </div>
            </div>
          </div>
        </header>
      );
    }

    /* ========== Footer (sinkron genre + klik untuk filter) ========== */
    function Footer({ genres = [], onPickGenre }) {
      const handlePick = (e, g) => {
        const url = `./home.html?genre=${encodeURIComponent(g)}`;
        if (onPickGenre) {
          e.preventDefault();
          onPickGenre(g);
          const sp = new URLSearchParams(location.search);
          sp.set('genre', g);
          history.replaceState(null, '', `?${sp.toString()}`);
        }
      };
      const genreList = (genres || []).filter(g => g !== 'Semua');

      return (
        <footer className="site-footer">
          <div className="foot-grid">
            <div className="foot-brand">
              <div className="logo-row"><i className="logo-box" aria-hidden="true">ðŸŽ¬</i> <span>CHILL</span></div>
              <p className="copy">Â©2025 Chill All Rights Reserved.</p>
            </div>
            <div className="foot-block foot-genre">
              <div className="foot-title">Genre</div>
              <ul className="foot-list genre-cols">
                {genreList.map(g => (
                  <li key={g}>
                    <a href={`./home.html?genre=${encodeURIComponent(g)}`} onClick={(e)=>handlePick(e,g)}>{g}</a>
                  </li>
                ))}
              </ul>
            </div>
            <div className="foot-block foot-help">
              <div className="foot-title">Bantuan</div>
              <ul className="foot-list">
                <li><a href="#">FAQ</a></li>
                <li><a href="#">Kontak Kami</a></li>
                <li><a href="#">Privasi</a></li>
                <li><a href="#">Syarat & Ketentuan</a></li>
              </ul>
            </div>
          </div>
        </footer>
      );
    }

    /* ========== Scroller ========== */
    function useHorizontalScroller(ref){
      useEffect(()=>{
        const el = ref.current; if(!el) return;
        const onWheel = e => { if(Math.abs(e.deltaY) > Math.abs(e.deltaX)){ e.preventDefault(); el.scrollLeft += e.deltaY; } };
        let down=false, sx=0, sl=0;
        const pd = e=>{ down=true; sx=e.pageX-el.offsetLeft; sl=el.scrollLeft; el.setPointerCapture?.(e.pointerId); el.classList.add('dragging'); };
        const pu = ()=>{ down=false; el.classList.remove('dragging'); };
        const mv = e=>{ if(!down) return; e.preventDefault(); el.scrollLeft = sl - ((e.pageX-el.offsetLeft)-sx)*1.2; };
        el.addEventListener('wheel', onWheel, {passive:false});
        el.addEventListener('pointerdown', pd); el.addEventListener('pointerup', pu);
        el.addEventListener('pointerleave', pu); el.addEventListener('pointermove', mv);
        return ()=>{ el.removeEventListener('wheel', onWheel); el.removeEventListener('pointerdown', pd);
          el.removeEventListener('pointerup', pu); el.removeEventListener('pointerleave', pu); el.removeEventListener('pointermove', mv); };
      },[ref]);
    }
    function Scroller({ariaLabel, children}){ const r=useRef(null); useHorizontalScroller(r); return <div ref={r} className="scroller" tabIndex={0} aria-label={ariaLabel}>{children}</div>; }

    /* ========== Data contoh ========== */
    const data = {
      hero: {
        id: 'duty-after-school',
        title: 'Duty After School',
        description: 'Sebuah benda tak dikenal mengancam dunia. Siswa sekolah menengah direkrut menjadi pasukan pertahanan.',
        ageTag: '18+',
        type: 'series',
        genres: ['Aksi','Drama','Sci-Fi'],
        backdrop: 'assets/backdrops/ted-lasso.jpg',
        episodes: [
          { no:1, title:'Episode 1: Ancaman dari Langit', duration:'45 m', desc:'Serangan pertama.', image:'' },
          { no:2, title:'Episode 2: Rekrutmen Paksa',     duration:'42 m', desc:'Kelas jadi barak.', image:'' },
          { no:3, title:'Episode 3: Pertempuran Pertama',  duration:'48 m', desc:'Misi lapangan.',    image:'' }
        ]
      },
      genres: ['Semua','Aksi','Drama','Sci-Fi','Thriller','Komedi','Romantis','Horror'],
      sections: [
        { title:'Top Rating Film dan Series Hari ini', items:[
          { id:'interstellar', title:'Interstellar', label:'Interstellar â€¢ â˜… 4.8', img:'https://image.tmdb.org/t/p/w500/gEU2QniE6E77NI6lCU6MxlNBvIx.jpg', genres:['Sci-Fi','Drama'], type:'film',
            overview:'Misi antarbintang demi kelangsungan hidup manusia.', backdrop:'assets/backdrops/interstellar.jpg' },
          { id:'the-dark-knight', title:'The Dark Knight', label:'The Dark Knight â€¢ â˜… 4.9', img:'https://image.tmdb.org/t/p/w500/1hRoyzDtpgMU7Dz4JF22RANzQO7.jpg', genres:['Aksi','Thriller'], type:'film',
            overview:'Batman vs Joker.', backdrop:'assets/backdrops/dark-knight.jpg' },
          { id:'guardians-vol-3', title:'Guardian of The Galaxy Vol. 3', label:'Guardian of The Galaxy Vol. 3 â€¢ â˜… 4.4', img:'https://image.tmdb.org/t/p/w500/r2J02Z2OpNTctfOSN1Ydgii51I3.jpg', genres:['Aksi','Komedi','Sci-Fi'], type:'film',
            overview:'Misi menyelamatkan teman lama.', backdrop:'assets/backdrops/gotg3.jpg' }
        ]},
        { title:'Rilis Baru', items:[
          { id:'dune-part-two', title:'Dune: Part Two', label:'Dune: Part Two â€¢ New', img:'https://image.tmdb.org/t/p/w500/1pdfLvkbY9ohJlCjQH2CZjjYVvJ.jpg', genres:['Sci-Fi','Petualangan'], type:'film',
            overview:'Kelanjutan epik di Arrakis.', backdrop:'assets/backdrops/dune2.jpg' }
        ]}
      ]
    };

    /* ========== UI konten ========== */
    function GenreFilter({ genres, selected, onChange }){
      return (
        <div className="genre-filter">
          {genres.map(g=>(
            <a key={g} href="#"
               className={`genre-chip ${selected===g?'active':''}`}
               onClick={(e)=>{ e.preventDefault(); onChange(g); }}>
              {g}
            </a>
          ))}
        </div>
      );
    }

    function Hero({ item, onShowDetail }){
      return (
        <section className="hero" aria-label="Hero film pilihan">
          <div className="hero-inner">
            <h2>{item.title}</h2>
            <p>{item.description}</p>
            <div className="actions">
              <a className="btn" href="./watch.html">Mulai</a>
              <a className="btn-outline" href="#" onClick={(e)=>{e.preventDefault(); onShowDetail(item);}}>Selengkapnya</a>
              <span className="tag">{item.ageTag}</span>
            </div>
          </div>
        </section>
      );
    }

    /* === Card (klik dimana saja untuk modal) === */
    function Card({ item, onShowDetail }) {
      const handleOpen = (e) => { e.preventDefault(); onShowDetail(item); };
      const handleKey = (e) => {
        if (e.key === 'Enter' || e.key === ' ') { e.preventDefault(); onShowDetail(item); }
      };

      return (
        <article
          className="card clickable-card"
          data-genres={(item.genres || ['Semua']).join(', ')}
          tabIndex={0}
          role="button"
          aria-label={`Lihat detail ${item.title}`}
          onClick={handleOpen}
          onKeyDown={handleKey}
        >
          <img
            loading="lazy"
            src={item.img}
            alt={item.title}
            onError={(e) => { e.currentTarget.onerror = null; e.currentTarget.src = 'https://via.placeholder.com/300x450?text=Poster'; }}
          />
          <div className="overlay"><p>{item.label || item.title}</p></div>
          <div className="hover-hint">Klik untuk detail</div>
        </article>
      );
    }

    /* === Detail Modal (inline style supaya tidak ketimpa CSS) === */
    function DetailModal({ open, onClose, item }) {
      if (!open || !item) return null;

      const isSeries = (item.type || '').toLowerCase() === 'series';
      const heroImg = item.backdrop || item.img || '';

      const backdropStyle = {
        position: 'fixed', inset: 0, background: 'rgba(0,0,0,.72)', zIndex: 3500
      };
      const modalStyle = {
        position: 'fixed', top: '50%', left: '50%', transform: 'translate(-50%, -50%)',
        width: 'min(960px, calc(100% - 32px))', maxHeight: '90vh', overflow: 'auto',
        background: '#111', border: '1px solid rgba(255,255,255,.08)', borderRadius: 16,
        padding: 16, zIndex: 3600, boxShadow: '0 20px 60px rgba(0,0,0,.6)'
      };

      return (
        <>
          <div className="backdrop" style={backdropStyle} onClick={onClose} />
          <div className="modal" style={modalStyle} role="dialog" aria-modal="true" aria-label="Detail Konten">
            <div
              className="modal-hero"
              style={{
                backgroundImage: `url('${heroImg}')`,
                backgroundSize: 'cover',
                backgroundPosition: 'center',
                aspectRatio: '16 / 9',
                borderRadius: 12
              }}
            />
            <div className="modal-header" style={{display:'flex',alignItems:'center',justifyContent:'space-between',margin:'10px 0'}}>
              <div className="modal-title" style={{fontWeight:700,fontSize:18}}>{item.title}</div>
              <button className="modal-close" onClick={onClose} aria-label="Tutup"
                style={{background:'rgba(255,255,255,.08)',border:'1px solid rgba(255,255,255,.15)',color:'#fff',borderRadius:999,width:36,height:36}}>
                âœ•
              </button>
            </div>

            <div className="modal-actions" style={{display:'flex',gap:8,margin:'8px 0 16px'}}>
              <a className="btn" href="./watch.html">Mulai</a>
              <button className="btn" aria-label="Tambah ke daftar">+</button>
            </div>

            <div style={{display:'grid',gridTemplateColumns:'repeat(3,minmax(0,1fr))',gap:12,marginBottom:12}}>
              <div><div className="meta">2023 â€¢ 10 episode â€¢ 16+</div></div>
              <div><b>Cast</b><div className="meta">â€”</div></div>
              <div><b>Genre</b><div className="meta">{(item.genres||[]).join(', ')}</div></div>
            </div>

            <p className="meta" style={{marginBottom:16}}>{item.overview || item.description || 'â€”'}</p>

            {isSeries ? (
              <section>
                <h3 style={{margin:'8px 0'}}>Episode</h3>
                <ol style={{listStyle:'none',padding:0,margin:0,display:'flex',flexDirection:'column',gap:10}}>
                  {(item.episodes||[]).map(ep=>(
                    <li key={ep.no} className="episode-card"
                        style={{display:'grid',gridTemplateColumns:'44px 140px 1fr auto',gap:12,padding:10,borderRadius:12,background:'rgba(255,255,255,.04)',border:'1px solid rgba(255,255,255,.06)'}}>
                      <div className="episode-no" style={{display:'flex',alignItems:'center',justifyContent:'center',fontWeight:700}}>{ep.no}</div>
                      <div className="episode-thumb"
                           style={{width:140,aspectRatio:'16/9',borderRadius:8,background:`#121212 url('${(ep.image && ep.image.trim()) ? ep.image : heroImg}') center / cover no-repeat`}} />
                      <div>
                        <div className="episode-title" style={{fontWeight:600}}>{ep.title}</div>
                        <div className="episode-desc" style={{color:'#acb5bf'}}>{ep.desc}</div>
                      </div>
                      <div className="episode-runtime">{ep.duration}</div>
                    </li>
                  ))}
                </ol>
              </section>
            ) : (
              <section>
                <h3 style={{margin:'8px 0'}}>Rekomendasi Serupa</h3>
                <div className="grid" style={{gridAutoFlow:'column',gridAutoColumns:'160px',overflow:'auto',gap:12,paddingBottom:8}}>
                  {(item.recommendations || [
                    { title:'The Tomorrow War', img:'https://image.tmdb.org/t/p/w200/xXHZeb1yhJvnSHPzZDqee0zfMb6.jpg' },
                    { title:'Guardians of the Galaxy', img:'https://image.tmdb.org/t/p/w200/r2J02Z2OpNTctfOSN1Ydgii51I3.jpg' },
                    { title:'Guardians Vol. 2', img:'https://image.tmdb.org/t/p/w200/y4MBh0EjBlMuOzv9axM4qJlmhzz.jpg' }
                  ]).map((rec,i)=>(
                    <div key={i} className="rec-card">
                      <img src={rec.img} alt={rec.title}
                           onError={(e)=>{e.currentTarget.onerror=null;e.currentTarget.src='https://via.placeholder.com/160x240?text=Poster';}} />
                      <div className="meta" style={{marginTop:6}}>{rec.title}</div>
                    </div>
                  ))}
                </div>
              </section>
            )}
          </div>
        </>
      );
    }

    /* ========== Halaman ========== */
    function App(){
      const [showProfile, setShowProfile] = React.useState(false);
      const [selectedGenre, setSelectedGenre] = React.useState('Semua');
      const [open, setOpen] = React.useState(false);
      const [selected, setSelected] = React.useState(null);

      const onShowDetail = (item)=>{ setSelected(item); setOpen(true); };

      // filter berdasarkan genre
      useEffect(()=>{
        const cards = document.querySelectorAll('.card[data-genres]');
        cards.forEach(c=>{
          if(selectedGenre==='Semua'){ c.style.display=''; return; }
          const g=(c.getAttribute('data-genres')||'').toLowerCase();
          c.style.display = g.includes(selectedGenre.toLowerCase()) ? '' : 'none';
        });
      }, [selectedGenre]);

      // set default genre dari URL (?genre=Aksi)
      useEffect(()=>{
        const sp = new URLSearchParams(location.search);
        const q = sp.get('genre');
        if (q && data.genres.includes(q)) setSelectedGenre(q);
      }, []);

      return (
        <>
          <Header showProfile={showProfile} setShowProfile={setShowProfile} />

          <main className="container" role="main">
            <Hero item={data.hero} onShowDetail={onShowDetail} />
            <GenreFilter genres={data.genres} selected={selectedGenre} onChange={setSelectedGenre} />

            {data.sections.map(sec=>(
              <section key={sec.title} className="section">
                <h3>{sec.title}</h3>
                <Scroller ariaLabel={`${sec.title} (geser untuk melihat lainnya)`}>
                  {sec.items.map((it,idx)=>(
                    <Card key={idx} item={it} onShowDetail={onShowDetail} />
                  ))}
                </Scroller>
              </section>
            ))}
          </main>

          <Footer genres={data.genres} onPickGenre={setSelectedGenre} />

          <DetailModal open={open} onClose={()=>setOpen(false)} item={selected} />
        </>
      );
    }

    ReactDOM.createRoot(document.getElementById('root')).render(<App />);
  </script>
</body>
</html>
